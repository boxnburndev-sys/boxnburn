<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Box N Burn</title>
  <style>
    * {margin:0;padding:0;box-sizing:border-box;}
    body {
      font-family:'Segoe UI',Arial,sans-serif;
      background:#f5f7fb;
      color:#333;
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }
    header {
      background:#0078d7;
      color:#fff;
      padding:15px 25px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      box-shadow:0 2px 5px rgba(0,0,0,0.2);
      position:sticky;
      top:0;
      z-index:1000;
    }
    .logo {font-size:22px;font-weight:bold;letter-spacing:1px;}
    nav a {
      color:#fff;
      margin:0 12px;
      text-decoration:none;
      font-weight:500;
      transition:opacity 0.2s;
    }
    nav a:hover {opacity:0.8;}
    .user-info {display:flex;align-items:center;gap:12px;}
    .user-info img {
      width:42px;height:42px;
      border-radius:50%;object-fit:cover;
      border:2px solid #fff;
    }
    .user-info span {font-size:14px;}
    .logout-btn {
      background:#ff4d4d;border:none;
      padding:8px 14px;color:#fff;
      border-radius:6px;cursor:pointer;
      font-size:14px;transition:background 0.2s;
    }
    .logout-btn:hover {background:#d93636;}
    .container {flex:1;padding:25px;}
    h2 {margin-bottom:15px;color:#222;}
    .card {
      background:#fff;border-radius:12px;
      box-shadow:0 3px 8px rgba(0,0,0,0.1);
      padding:20px;margin-bottom:20px;
    }
    .grid {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
      gap:20px;
    }
    .person-card {
      text-align:center;padding:18px;
      background:#fff;border-radius:12px;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
      transition:transform 0.2s,box-shadow 0.2s;
    }
    .person-card:hover {
      transform:translateY(-5px);
      box-shadow:0 6px 14px rgba(0,0,0,0.15);
    }
    .person-card img {
      width:100px;height:100px;
      border-radius:50%;object-fit:cover;
      margin-bottom:12px;border:3px solid #0078d7;
    }
    .person-card h3 {margin:10px 0 6px;font-size:18px;color:#111;}
    .person-card p {margin:4px 0;font-size:14px;color:#555;}
    table {
      width:100%;border-collapse:collapse;
      background:#fff;border-radius:10px;
      overflow:hidden;box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    table th,table td {
      padding:12px;text-align:left;
      border-bottom:1px solid #eee;
    }
    table th {background:#0078d7;color:#fff;font-weight:600;}
    table tr:hover {background:#f1f5fb;}
    .section {animation:fadeIn 0.4s ease;}
    @keyframes fadeIn {
      from{opacity:0;transform:translateY(10px);}
      to{opacity:1;transform:translateY(0);}
    }
    footer {
      background:#0078d7;color:#fff;
      text-align:center;padding:12px;
      font-size:13px;margin-top:auto;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">Box N Burn Dashboard</div>
    <nav>
      <a href="#" onclick="showSection('home')">Home</a>
      <a href="#" onclick="showSection('team')">Ons Team</a>
      <a href="#" onclick="showSection('leden')">Leden</a>
      <a href="#" onclick="showSection('reserveringen')">Reserveringen</a>
    </nav>
    <div class="user-info">
      <span><b id="username"></b> (<span id="role"></span>)</span>
      <img id="pfp" src="" alt="pfp">
      <button class="logout-btn" onclick="logout()">Log uit</button>
    </div>
  </header>

  <div class="container">
    <section id="home" class="section">
      <div class="card">
        <h2>Welkom bij Box N Burn</h2>
        <p>Dit is je persoonlijke dashboard. Gebruik de navigatie om verder te gaan.</p>
      </div>
    </section>

    <section id="team" class="section" style="display:none;">
      <h2>Ons Team</h2>
      <div class="grid" id="personnelGrid"></div>
    </section>

    <section id="leden" class="section" style="display:none;">
      <h2>Leden</h2>
      <div class="card">
        <h3>Boksen</h3>
        <table><thead><tr><th>ID</th><th>Naam</th><th>Contact</th></tr></thead><tbody id="ledenBoksen"></tbody></table>
        <h3>Yoga</h3>
        <table><thead><tr><th>ID</th><th>Naam</th><th>Contact</th></tr></thead><tbody id="ledenYoga"></tbody></table>
        <h3>Spinning</h3>
        <table><thead><tr><th>ID</th><th>Naam</th><th>Contact</th></tr></thead><tbody id="ledenSpinning"></tbody></table>
      </div>
    </section>

    <section id="reserveringen" class="section" style="display:none;">
      <h2>Reserveringen</h2>
      <div class="card">
        <table>
          <thead><tr><th>ID</th><th>Naam</th><th>Les</th><th>Datum</th><th>Tijd</th><th>Contact</th></tr></thead>
          <tbody id="reservationTable"></tbody>
        </table>
      </div>
    </section>
  </div>

  <footer>
    &copy; 2025 Box N Burn. Alle rechten voorbehouden.
  </footer>

  <script>
    const SHEET_ID = "1ysGbVJJ5LO5d4vF3K-Prc-PtO9OMSe0xmL3EfvpNU48";
    const API_KEY = "AIzaSyDIo56Keur-KzkIECQ0bih0fia9DVkpkng";

    async function fetchSheetData(sheetId, range) {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${API_KEY}`;
      const res = await fetch(url);
      const data = await res.json();
      return data.values || [];
    }

    async function loadUserInfo() {
      const loggedUser = localStorage.getItem("loggedInUser");
      if (!loggedUser) {
        window.location.href = "login.html";
        return;
      }
      const rows = await fetchSheetData(SHEET_ID, "Users!A2:E");
      const match = rows.find(r => r[0] === loggedUser);
      if (match) {
        const [username,,role,bio,pfp] = match;
        document.getElementById("username").textContent = username;
        document.getElementById("role").textContent = role;
        document.getElementById("pfp").src = pfp;
        localStorage.setItem("userRole", role);
        localStorage.setItem("userPfp", pfp);
        localStorage.setItem("userBio", bio);
      } else { logout(); }
    }

    async function loadPersonnelFromUsers() {
      const rows = await fetchSheetData(SHEET_ID, "Users!A2:E");
      const grid = document.getElementById("personnelGrid");
      grid.innerHTML = "";
      rows.forEach(r => {
        const [username,,role,bio,pfp] = r;
        const card = document.createElement("div");
        card.className = "person-card";
        card.innerHTML = `
          <img src="${pfp}" alt="${username}">
          <h3>${username}</h3>
          <p><b>Rol:</b> ${role}</p>
          <p><b>Bio:</b> ${bio || ""}</p>
        `;
        grid.appendChild(card);
      });
    }

    async function loadLedenFromSheet() {
      const rows = await fetchSheetData(SHEET_ID, "Leden!A2:D");
      const boksen = document.getElementById("ledenBoksen");
      const yoga = document.getElementById("ledenYoga");
      const spinning = document.getElementById("ledenSpinning");
      boksen.innerHTML="";yoga.innerHTML="";spinning.innerHTML="";
      rows.forEach(r => {
        const [id,naam,les,contact] = r;
        const row = `<tr><td>${id}</td><td>${naam}</td><td>${contact}</td></tr>`;
        if(les==="Boksen") boksen.innerHTML+=row;
        if(les==="Yoga") yoga.innerHTML+=row;
        if(les==="Spinning") spinning.innerHTML+=row;
      });
    }

    async function loadReserveringenFromSheet() {
      const rows = await fetchSheetData(SHEET_ID, "Reserveringen!A2:F");
      const table = document.getElementById("reservationTable");
      table.innerHTML="";
      rows.forEach(r => {
        const [id,naam,les,datum,tijd,contact] = r;
        table.innerHTML += `<tr><td>${id}</td><td>${naam}</td><td>${les}</td><td>${datum}</td><td>${tijd}</td><td>${contact}</td></tr>`;
      });
    }

    function showSection(id) {
      document.querySelectorAll(".section").forEach(sec=>sec.style.display="none");
      document.getElementById(id).style.display="block";
    }

    function logout() {
      localStorage.clear();
      window.location.href = "login.html";
    }

    loadUserInfo();
    loadPersonnelFromUsers();
    loadLedenFromSheet();
    loadReserveringenFromSheet();
    setInterval(()=>{
      loadLedenFromSheet();
      loadReserveringenFromSheet();
    },30000);
  </script>
</body>
</html>
