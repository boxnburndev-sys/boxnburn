<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Box N Burn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * {margin:0; padding:0; box-sizing:border-box;}
    body {font-family:'Segoe UI', Arial, sans-serif; background:#121212; color:#f1f1f1; min-height:100vh;}
    .navbar {display:flex; justify-content:space-between; align-items:center; padding:14px 28px; background:#0a0a0a; box-shadow:0 4px 14px rgba(0,0,0,0.6); position:sticky; top:0; z-index:50;}
    .brand {font-size:22px; font-weight:700; color:#0f93ff;}
    .menu {display:flex; gap:14px; align-items:center;}
    .menu button {background:#1c1c1c; border:2px solid #2a2a2a; padding:9px 18px; border-radius:20px; cursor:pointer; font-weight:600; color:#f1f1f1; transition:all 0.2s ease;}
    .menu button:hover {transform:scale(1.08); background:#2a2a2a;}
    .menu button.active {background:#0f93ff; color:#fff; border-color:#0f93ff;}
    .user-info {display:flex; align-items:center; gap:14px;}
    .user-info img {width:44px; height:44px; border-radius:50%; border:2px solid #0f93ff; object-fit:cover;}
    .user-info .details {text-align:right;}
    .user-info .details .name {font-weight:600;}
    .user-info .details .role {font-size:13px; opacity:0.85;}
    .content {padding:28px;}
    .hidden {display:none;}
    .card {background:#1c1c1c; border-radius:14px; padding:22px; margin-bottom:24px; box-shadow:0 4px 14px rgba(0,0,0,0.6);}
    table {width:100%; border-collapse:collapse; margin-top:12px; background:#121212; border-radius:12px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.6);}
    table th, table td {padding:12px; border-bottom:1px solid #2a2a2a; text-align:left;}
    table th {background:#0a0a0a; font-weight:600; color:#0f93ff;}
    table tr:hover {background:#1c1c1c;}
    .personnel-grid {display:grid; grid-template-columns:repeat(auto-fit, minmax(250px,1fr)); gap:18px; margin-top:22px;}
    .person-card {background:#121212; border-radius:14px; padding:18px; box-shadow:0 4px 12px rgba(0,0,0,0.6); text-align:center;}
    .person-card img {width:110px; height:110px; border-radius:50%; border:3px solid #0f93ff; object-fit:cover; margin-bottom:12px;}
    .person-card h3 {margin:0; font-size:18px; color:#0f93ff;}
    .person-card p {margin:6px 0; font-size:14px; color:#ccc;}
    .loading-screen {position:fixed; top:0; left:0; width:100%; height:100%; background:url('https://i.ibb.co/5XkVnKjY/Boxing-Spinning-Yoga.png') no-repeat center center fixed; background-size:cover; display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:2000;}
    .loading-overlay {position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.65); backdrop-filter:blur(8px);}
    .loading-content {position:relative; z-index:1; text-align:center; color:#fff;}
    .loading-content img {width:110px; height:110px; border-radius:50%; border:3px solid #0f93ff; object-fit:cover; margin-bottom:18px;}
    .loading-content h2 {font-size:26px; margin-bottom:22px;}
    .loading-bar {width:320px; height:12px; background:rgba(255,255,255,0.2); border-radius:20px; overflow:hidden; margin:0 auto;}
    .loading-fill {height:100%; width:0; background:#0f93ff; animation:fill 2s forwards;}
    @keyframes fill {from{width:0;} to{width:100%;}}
  </style>
</head>
<body>
  <div class="loading-screen" id="loadingScreen">
    <div class="loading-overlay"></div>
    <div class="loading-content">
      <img id="loadingPfp" src="" alt="Profile">
      <h2 id="loadingText">Welkom...</h2>
      <div class="loading-bar"><div class="loading-fill"></div></div>
    </div>
  </div>

  <div class="navbar">
    <div class="brand">Box N Burn</div>
    <div class="menu">
      <button onclick="showTab('team')" id="btnTeam">Ons Team</button>
      <button onclick="showTab('leden')" id="btnLeden">Leden</button>
      <button onclick="showTab('reserveringen')" id="btnReserveringen">Reserveringen</button>
    </div>
    <div class="user-info">
      <div class="details">
        <div class="name" id="navName"></div>
        <div class="role" id="navRole"></div>
      </div>
      <img id="navPfp" src="" alt="pfp">
    </div>
  </div>

  <div class="content">
    <div id="teamTab" class="tab">
      <h2>Ons Team</h2>
      <div class="personnel-grid" id="teamGrid"></div>
    </div>
    <div id="ledenTab" class="tab hidden">
      <h2>Leden</h2>
      <div class="card"><h3>Boksen</h3><table id="boksenTable"></table></div>
      <div class="card"><h3>Yoga</h3><table id="yogaTable"></table></div>
      <div class="card"><h3>Spinning</h3><table id="spinningTable"></table></div>
    </div>
    <div id="reserveringenTab" class="tab hidden">
      <h2>Reserveringen</h2>
      <div class="card"><table id="reserveringenTable"></table></div>
    </div>
  </div>

  <script>
    const SHEET_ID = "1ysGbVJJ5LO5d4vF3K-Prc-PtO9OMSe0xmL3EfvpNU48";
    const API_KEY = "AIzaSyDIo56Keur-KzkIECQ0bih0fia9DVkpkng";

    const navName = document.getElementById("navName");
    const navRole = document.getElementById("navRole");
    const navPfp = document.getElementById("navPfp");
    const teamGrid = document.getElementById("teamGrid");
    const boksenTable = document.getElementById("boksenTable");
    const yogaTable = document.getElementById("yogaTable");
    const spinningTable = document.getElementById("spinningTable");
    const reserveringenTable = document.getElementById("reserveringenTable");
    const loadingScreen = document.getElementById("loadingScreen");
    const loadingText = document.getElementById("loadingText");
    const loadingPfp = document.getElementById("loadingPfp");

    const loggedInUser = localStorage.getItem("loggedInUser");

    async function fetchSheet(range) {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${range}?key=${API_KEY}`;
      const res = await fetch(url);
      return await res.json();
    }

    function showTab(tab) {
      document.querySelectorAll(".tab").forEach(t => t.classList.add("hidden"));
      document.getElementById(tab + "Tab").classList.remove("hidden");
      document.querySelectorAll(".menu button").forEach(b => b.classList.remove("active"));
      document.getElementById("btn" + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add("active");
    }

    function renderTable(element, headers, rows) {
      let html = "<thead><tr>";
      headers.forEach(h => html += `<th>${h}</th>`);
      html += "</tr></thead><tbody>";
      rows.forEach(r => {
        html += "<tr>";
        headers.forEach((_, i) => {
          html += `<td>${r[i] || ""}</td>`;
        });
        html += "</tr>";
      });
      html += "</tbody>";
      element.innerHTML = html;
    }

    async function init() {
      const usersData = await fetchSheet("Users!A2:E");
      if (usersData.values) {
        const users = {};
        usersData.values.forEach(row => {
          const [username, password, role, bio, pfp] = row;
          users[username] = {role, bio, pfp};
          const card = document.createElement("div");
          card.className = "person-card";
          card.innerHTML = `<img src="${pfp}" alt="${username}">
                            <h3>${username}</h3>
                            <p><strong>${role}</strong></p>
                            <p>${bio}</p>`;
          teamGrid.appendChild(card);
        });
        if (users[loggedInUser]) {
          navName.textContent = loggedInUser;
          navRole.textContent = users[loggedInUser].role;
          navPfp.src = users[loggedInUser].pfp;
          loadingText.textContent = `Welkom, ${loggedInUser}`;
          loadingPfp.src = users[loggedInUser].pfp;
        }
      }

      const ledenData = await fetchSheet("Leden!A1:D");
      if (ledenData.values) {
        const headers = ledenData.values[0]; 
        const rows = ledenData.values.slice(1); 
        renderTable(boksenTable, headers, rows.filter(r => r[2] === "Boksen"));
        renderTable(yogaTable, headers, rows.filter(r => r[2] === "Yoga"));
        renderTable(spinningTable, headers, rows.filter(r => r[2] === "Spinning"));
      }

      const resData = await fetchSheet("Reserveringen!A1:F");
      if (resData.values) {
        const headers = resData.values[0]; 
        const rows = resData.values.slice(1); 
        renderTable(reserveringenTable, headers, rows);
      }

      setTimeout(() => loadingScreen.style.display = "none", 2200);
      showTab("team");
    }

    init();
  </script>
</body>
</html>
